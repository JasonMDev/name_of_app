<!-- Individual Product Page -->

<!-- Debug info: shows in terminal -->
<% logger.debug " "%>
<% logger.debug "---=== Logger Debug ===---"%>
<% logger.debug "-  Product ID: #{@product.id}"%>
<% logger.debug "-  Product Name: #{@product.name}"%>
<% logger.debug "-  Page Param ID: #{params[:id]}"%>
<% logger.debug "---=== END ===---"%>
<% logger.debug " "%>

<!-- Alternative Ratings show using scopes and custom methods -->
<%# @product.comments.order(rating: :desc).first.rating %>
<%# @product.comments.rating_desc.first.rating %>
<%# @product.highest_rating_comment.rating %>

<!-- Bread Crumb -->
<ul class="breadcrumb">
  <li><%= link_to ('<span class="glyphicon glyphicon-home"></span>').html_safe, root_path %></li>
  <li><%= link_to 'Bicycles', products_path %></li>
  <li><%= link_to 'Custom Made Bicycles', products_path %></li>
  <li class="active"><%= @product.name %></li>
  <div class="pull-right">
    <!-- Buttons floated to the right -->
    <%= link_to ('<span class="glyphicon glyphicon-check"></span> &nbsp Add to basket ').html_safe, edit_product_path(@product), class: "btn btn-primary btn-xs", role: "button" %>
    <%= link_to ('<span class="glyphicon glyphicon-backward"></span> &nbsp Back ').html_safe, products_path, class: "btn btn-primary btn-xs", role: "button" %>
    <% if signed_in? && current_user.admin? %>
      <%= link_to ('<span class="glyphicon glyphicon-edit"></span>').html_safe, edit_product_path(@product), class: "btn btn-warning btn-xs" %>
      <%= link_to ('<span class="glyphicon glyphicon-trash"></span>').html_safe, @product, class: "btn btn-danger btn-xs", method: :delete, data: { confirm: 'Are you sure?' }%>
    <% end %>
  </div>
</ul><!-- / Bread Crumb -->

<!-- Page Header -->
<div class="page-header center">
  <h1><%= @product.name %>&nbsp | &nbsp<small><%= @product.description %></small></h1>
</div>

<!-- Body of Page -->
<div class="row">
  <!-- Cache Wrapper for individual product -->
  <% cache @product do %>

    <!-- Product Image -->
    <section id="product-image" class="bg-success col-xs-12 col-sm-4 col-md-4 col-lg-4">
      <!-- Product Image -->
      <h2>Product Image</h2>
      <%= image_tag(@product.image_url, width: "350", class: "img-responsive img-zoom", data_zoom_image: @product.image_url) %>
    </section><!-- /Product Image -->

    <!-- Product Details -->
    <section id="product-details" class="bg-info col-xs-12 col-sm-8 col-md-8 col-lg-8">
      <h2>Product Details</h2>
      <!-- Product Name -->
      <h4><%= @product.name %></h4>
      <!-- Average Rating View -->
      <hr>
      <p>
        <strong>Average Rating:</strong>
        ( &nbsp
        <%= pluralize(@product.total_rating.to_f, "customer review") %>
        &nbsp )
        <div id="average-rating1" class="rated" data-score="<%= @product.average_rating %>">
        </div>

      </p>
      <hr>

      <p><strong>Name: &nbsp</strong><%= @product.name %></p>
      <p><strong>Description: &nbsp</strong><%= @product.description %></p>
      <p><strong>Color: &nbsp</strong><%= @product.color %></p>
      <p><strong>Location: &nbsp</strong><%= @product.location %></p>
      <p>
        <strong>Price:</strong>
        &nbsp
        <%= number_to_currency(@product.price, unit: "Â£", separator: ".", delimiter: "") %>
      </p>
      <p>
        <!-- Stripe payment button -->
        <%= form_tag "/payments/create" do %>
          <%= render partial: "shared/stripe_checkout_button" %>
          <%= hidden_field_tag(:product_id, @product.id) %>
        <% end %>
      </p>
    </section><!-- /Product Details -->

    <!-- Product Comments : Current -->
    <section id="product-comments--current" class="bg-warning col-md-12">
      <h2>Product Comments</h2>
      <%= render 'comments' %>
    </section><!-- /Product Comments -->

    <!-- Product Comments : New -->
    <section id="product-comments--new" class="bg-danger col-md-12">
      <h2>New Comments</h2>
      <%= render 'new_comment' %>
    </section><!-- /New Comments -->

  <% end %>  <!-- /Cache -->
</div><!-- /row -->
